# üì∑ Security Cam

## ‚ö° Introduction:

This implementation demonstrates a Security-Camera Software which was written in javascript
and uses `cocossd` offered by `ml5` to detect objects.

image::https://github.com/MarcoSteinke/Security-Cam/blob/main/img/screenshot.png?raw=true[width=800]

## ‚ùì Problem:

A business needs a security camera, but is low on server capacity. Thatswhy the business
can not store videos 24/7.

## üí° Solution:

Using Machine Learning, we can tell the camera when it has objects in view and use a lightweight
backend to store the timestamps and also the type of objects which where detected. 

#### Classification:
After detection, the software later classifies them as certain targets. 

#### Persistence

If the classified object is one of the targets, it will be persisted in the database
by giving information on its type and also adding a timestamp and date. Now we know
when to start recording and stop after a predefined amount of time passed.

## üí™ Improvements over conventional Security Cameras:

* installation is very easy and very customizable due to Open Source Technology
* detection of persons is a standard problem of Machine Learning and already has a very high precision
* destroy video material in which nothing happens, you will only store critical/important moments

## üèÜ Features:

‚≠ê advance your security by getting additional information from your camera.
  
‚≠ê super simple setup.

‚≠ê modern dashboard and webpages to access the cameras.

‚≠ê combine any hardware with this software.

‚≠ê lightweight and fast.

‚≠ê optimized amount of video data.

‚≠ê Machine Learning used to detect certain targets.

‚≠ê predefine intervals to control data produced by the camera.

‚≠ê very simple database structure.

## ‚ÑπÔ∏è Demo:

‚ö†Ô∏è At the moment the demo may not work correctly in your browser. (`6th March 2021`)

* click https://www.bestofcode.net/Applications/Security-Camera[‚Ñπ here] to open the demo in your web browser.

‚ö†Ô∏è make sure your webcam is allowed.

‚ö†Ô∏è if "model loading" does not change, please RELOAD (F5)

* open the developer console in your browser (F12 Chrome/Chromium, CTRL+SHIFT+S Firefox).
* type for example `DATABASE` and hit enter to inspect the database instance.
* type `DATABASE.db` and hit enter to inspect the content of the database.

INFORMATION: more to follow in the future.

## ‚úé Example Data from the Database:

#### 1. Collection of `Detection`'s

```javascript
MockDatabase {db: Array(8), lastDetection: 1603531578818}
db: Array(9)
0: Detection {id: 1, objects: Array(1), date: 1603531508193, dateObject: Sat Oct 24 2020 11:25:08 GMT+0200 (Mitteleurop√§ische Sommerzeit)}
1: Detection {id: 2, objects: Array(1), date: 1603531518319, dateObject: Sat Oct 24 2020 11:25:18 GMT+0200 (Mitteleurop√§ische Sommerzeit)}
2: Detection
  date: 1603531528418
  dateObject: Sat Oct 24 2020 11:25:28 GMT+0200 (Mitteleurop√§ische Sommerzeit) {}
  id: 3
  objects: Array(1)
  0: {label: "person", confidence: 0.7510808706283569, x: 7.6421356201171875, y: 2.8800487518310547, width: 626.8524932861328, ‚Ä¶}
  length: 1
  __proto__: Array(0)
  __proto__: Object
3: Detection {id: 4, objects: Array(0), date: 1603531538488, dateObject: Sat Oct 24 2020 11:25:38 GMT+0200 (Mitteleurop√§ische Sommerzeit)}
4: Detection {id: 5, objects: Array(1), date: 1603531548599, dateObject: Sat Oct 24 2020 11:25:48 GMT+0200 (Mitteleurop√§ische Sommerzeit)}
5: Detection {id: 6, objects: Array(1), date: 1603531558734, dateObject: Sat Oct 24 2020 11:25:58 GMT+0200 (Mitteleurop√§ische Sommerzeit)}
6: Detection
  date: 1603531568792
  dateObject: Sat Oct 24 2020 11:26:08 GMT+0200 (Mitteleurop√§ische Sommerzeit) {}
  id: 7
  objects: Array(0)
  length: 0
  __proto__: Array(0)
  __proto__: Object
7: Detection
  date: 1603531578818
  dateObject: Sat Oct 24 2020 11:26:18 GMT+0200 (Mitteleurop√§ische Sommerzeit) {}
  id: 8
  objects: Array(0)
  length: 0
  __proto__: Array(0)
  __proto__: Object
8: Detection
  date: 1603531588867
  dateObject: Sat Oct 24 2020 11:26:28 GMT+0200 (Mitteleurop√§ische Sommerzeit) {}
  id: 9
  objects: Array(1)
    0: {label: "person", confidence: 0.8875717520713806, x: 4.159679412841797, y: 1.1598587036132812, width: 632.5449562072754, ‚Ä¶}
    length: 1
  __proto__: Array(0)
  __proto__: Object
  length: 9
  __proto__: Array(0)
  lastDetection: 1603531588867
  __proto__: Object
```

#### 2. A single Detection

```javascript
8: Detection
  date: 1603531588867
  dateObject: Sat Oct 24 2020 11:26:28 GMT+0200 (Mitteleurop√§ische Sommerzeit) {}
  id: 9
  objects: Array(1)
    0:
      confidence: 0.8875717520713806
      height: 477.72010803222656
      label: "person"
      normalized: {x: 0.006499499082565308, y: 0.002416372299194336, width: 0.9883514940738678, height: 0.9952502250671387}
      width: 632.5449562072754
      x: 4.159679412841797
      y: 1.1598587036132812
    __proto__: Object
    length: 1
  __proto__: Array(0)
  __proto__: Object
length: 9
__proto__: Array(0)
lastDetection: 1603531588867
```

#### 3. A single Detection as JSON

```javascript
{id: 1, objects: Array(1), date: 1615052099545, dateObject: Sat Mar 06 2021 18:34:59 GMT+0100 (Mitteleurop√§ische Normalzeit)}
```

The objects list:

```javascript
{label: "person", confidence: 0.9367305040359497, x: 133.67712020874023, y: 16.696457862854004, width: 474.5007514...
```

Where it looks as follows:

```javascript
confidence: 0.9367305040359497
height: 458.1805944442749
label: "person"
normalized: {x: 0.20887050032615662, y: 0.034784287214279175, width: 0.7414074242115021, height: 0.9545429050922394}
width: 474.5007514953613
x: 133.67712020874023
y: 16.696457862854004
```

## üèõÔ∏è Architecture:

image::https://raw.githubusercontent.com/MarcoSteinke/Security-Cam/main/img/architecture-color.png[width=600]


## üîß Compatibility:

* [ ] IP Security Camera
* [ ] Analog MPX Security Camera
* [ ] Analog MPX Wireless Security Camera
* [ ] Wire-Free Security Camera Wiring
* [x] Wi-Fi Security Camera Wiring

#### Problem:

This security software has to become a module in security networks which is located between the actual video
input device and the DVR if the video input device is not wireless or NVR if the video input device is wireless.


#### Example Network (IP Security Camera):

image::https://www.lorextechnology.com/images/articles/content/HowToInstall/v2/images/Installation-diagrams_IP-G.png[width=600]

In this system of an IP Security Camera you will find a cable which connects the NVR and the video input device by 
using power-over-ethernet (POE) technology to https://www.lorextechnology.com/articles/how-to-install["provide both power and video transmission"].

This setup leaves no space for an external software which directly controls the video input stream. This problem is
architectural and has to be solved by this software to achieve the highest possible compatibility.

#### Solution:

* 1. Backwards Integration:

When using the Backwards Integration, the software should be run on a server which is directly connected to the
DVR/NVR and will rewatch the video material recorded, filter unimportant video information and redirect it
either to the DVR/NVR or to the server to reduce the amount of data saved.

* 2. Automated Video Analysis:

Using this method, the software is run on a server just as in the previous example. The software will then 
rewatch the video information received from the DVR/NVR and collect timestamps which flag video intervals in which
target objects could be detected. You can then either keep your videos as they are or use the time stamps to
remove unimportant sequences.

More solutions have to come, but at the moment there is no idea to manipulate the video input stream between the 
video input device and the DVR/NVR, which would be the ultimate use-case for this software.

## ‚òÅÔ∏è Planned Features:

* [ ] cloud support
* [ ] support of various sensors
* [ ] UI to manage connected devices / settings
* [ ] server implementation to offer a central responsibility for persistence (server 1:n cameras nets)

## üåê Useful Links

* https://www.lorextechnology.com/articles/how-to-install[How to Install Security Cameras]
* https://www.fortinet.com/content/dam/fortinet/assets/white-papers/wp-ip-surveillance-camera.pdf[Fortinet about surveillance]
* https://de.wikipedia.org/wiki/Netzwerkkamera[Network Cameras]
* https://de.wikipedia.org/wiki/Video%C3%BCberwachungsanlage[Video Surveillance System]
* https://kintronics.com/resources/faqs-ip-camera-systems/#2[Frequently Asked Questions or FAQs about IP Camera Systems]
* https://richmondalarm.com/security-tips/nvr-dvr-pros-cons[NVR vs DVR: Pros and Cons]
* https://en.wikipedia.org/wiki/Network_video_recorder[Network Video Recorder]

## ‚öñÔ∏è License

#### MIT License

#### Copyright (c) 2020 Marco Steinke

You will find the License https://github.com/MarcoSteinke/Security-Cam/blob/main/LICENSE[here]
